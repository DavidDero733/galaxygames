<!-- Add this just before </body> -->
<script>
(function(){
  // Create a container for the iframe (hidden until first use)
  const container = document.createElement('div');
  container.id = 'embedded-frame-container';
  container.style.position = 'fixed';
  container.style.left = '0';
  container.style.right = '0';
  container.style.bottom = '0';
  container.style.top = '10%';
  container.style.background = 'white';
  container.style.zIndex = '9999';
  container.style.display = 'none';
  container.style.borderTop = '4px solid #333';
  document.body.appendChild(container);

  // Close button
  const closeBtn = document.createElement('button');
  closeBtn.textContent = 'Close';
  closeBtn.style.position = 'absolute';
  closeBtn.style.right = '10px';
  closeBtn.style.top = '6px';
  closeBtn.style.zIndex = '10000';
  closeBtn.addEventListener('click', () => container.style.display = 'none');
  container.appendChild(closeBtn);

  // iframe that will show the target page
  const iframe = document.createElement('iframe');
  iframe.id = 'embedded-frame';
  iframe.style.width = '100%';
  iframe.style.height = '100%';
  iframe.style.border = '0';
  container.appendChild(iframe);

  // Intercept clicks on links
  document.addEventListener('click', function(ev){
    const a = ev.target.closest && ev.target.closest('a');
    if (!a) return;

    // You can adjust the rule below to match which links you want intercepted.
    // This example intercepts links that point to the site's internal "/view/unblocked-galaxy" pages
    const href = a.getAttribute('href') || '';
    const dataUrl = a.getAttribute('data-url') || '';

    const isInternalViewLink =
      href.startsWith('/view/unblocked-galaxy') || dataUrl.startsWith('/view/unblocked-galaxy');

    if (isInternalViewLink) {
      ev.preventDefault();
      // Use data-url if present (Google Sites sometimes uses a data-url attribute)
      const target = dataUrl || href;
      // If target is a relative path, convert it to an absolute URL using the origin
      const url = (target.startsWith('/') ? window.location.origin + target : target);

      // load into iframe and show container
      iframe.src = url;
      container.style.display = 'block';
      // optional: scroll to top so iframe is visible
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  }, true);
})();
</script>
